# Configuration

## .env reference

Copy `.env.example` to `.env` and fill in your values:

```bash
cp .env.example .env
nano .env
```

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `BITCOIND_RPC_USER` | Yes | — | Must match your `bitcoin.conf` |
| `BITCOIND_RPC_PASS` | Yes | — | Must match your `bitcoin.conf` |
| `WALLET_PASS` | No | *(prompted)* | LND wallet password (min 8 chars) |
| `BITCOIND_HOST` | No | `127.0.0.1` | Bitcoin Core host |
| `BITCOIND_RPC_PORT` | No | `18443` | Bitcoin Core RPC port |
| `MINER_WALLET` | No | `miner` | Wallet name in bitcoind for mining |
| `LND_IMAGE` | No | `lightninglabs/lnd:v0.20.1-beta` | LND Docker image |
| `FUND_LND1_BTC` | No | `8` | BTC to fund lnd1 |
| `FUND_LND2_BTC` | No | `3` | BTC to fund lnd2 |
| `FUND_LND3_BTC` | No | `6` | BTC to fund lnd3 |
| `CHANNEL_SATS` | No | `500000000` | lnd1↔lnd2 channel capacity in sats |
| `REBALANCE_SATS` | No | `250000000` | Amount to push for balancing lnd1↔lnd2 |
| `LND3_CHANNEL_SATS` | No | `250000000` | lnd3 channel capacity to lnd1 and lnd2 |
| `RTL_IMAGE` | No | `shahanafarooqui/rtl:v0.15.8` | RTL Docker image |
| `RTL_PORT` | No | `3000` | RTL web UI port |
| `RTL_PASSWORD` | No | *(WALLET_PASS)* | RTL login password |
| `RTL_DOMAIN` | No | *(disabled)* | Domain for HTTPS access to RTL (enables nginx reverse proxy) |
| `MOSTRO_REPO` | No | `https://github.com/MostroP2P/mostro.git` | Mostro git repo (cloned and built from source) |
| `MOSTRO_NSEC_PRIVKEY` | No | *(prompted)* | Nostr private key for Mostro |
| `MOSTRO_NPUB` | No | *(auto-detected)* | Nostr public key (required with `MOSTRO_NSEC_PRIVKEY` for admin tools) |
| `MOSTRO_RELAYS` | No | `wss://nos.lol,wss://relay.mostro.network` | Nostr relays (comma-separated) |
| `MOSTRIX_REPO` | No | `https://github.com/MostroP2P/mostrix.git` | MostriX TUI client repo |
| `LNURL_DOMAIN` | No | *(disabled)* | Domain for Lightning Address (enables nginx + satdress + certbot) |
| `LNURL_USERNAMES` | No | `admin` | Comma-separated usernames (`admin,user2`) |
| `SATDRESS_PORT` | No | `17422` | satdress HTTP port |

## Directory structure

```
~/BTC/lnd/
├── setup.sh
├── .env.example           # template (committed)
├── .env                   # your credentials (git-ignored)
├── docker-compose.yml     # generated by the script
├── summary.txt            # generated — setup summary (chmod 600)
├── lnd1/
│   ├── lnd.conf           # generated
│   └── data/
│       ├── seed.txt        # 24-word mnemonic
│       └── wallet-password.txt
├── lnd2/
│   ├── lnd.conf
│   └── data/
│       ├── seed.txt
│       └── wallet-password.txt
├── lnd3/
│   ├── lnd.conf
│   └── data/
│       ├── seed.txt
│       └── wallet-password.txt
├── rtl/
│   ├── RTL-Config.json    # generated
│   └── database/
├── mostro-src/             # cloned from git (built locally)
├── mostrix-src/            # MostriX TUI (cloned from git, built locally)
├── mostro/
│   ├── settings.toml       # generated
│   └── nostr-private.txt   # nsec key (chmod 600)
└── satdress/               # only if LNURL_DOMAIN is set
    ├── .env                # generated (chmod 600)
    └── data/
```

## Ports

All services bind to `127.0.0.1` only (not accessible from the internet).

| Service | lnd1 | lnd2 | lnd3 |
|---------|------|------|------|
| P2P | 9735 | 9736 | 9737 |
| gRPC | 10009 | 10010 | 10011 |
| REST | 8080 | 8081 | 8082 |

| Service | Port |
|---------|------|
| RTL web UI | 3000 |
| bitcoind P2P | 18444 |
| bitcoind RPC | 18443 |
| ZMQ block | 28332 |
| ZMQ tx | 28333 |
| satdress | 17422 |

If `RTL_DOMAIN` or `LNURL_DOMAIN` is set, nginx also listens on ports 80 and 443 (on `0.0.0.0`). See [security.md](security.md) for details.
