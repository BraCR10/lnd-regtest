# Mostro (P2P exchange)

[Mostro](https://github.com/MostroP2P/mostro) is a P2P Bitcoin trading daemon over the Nostr protocol. It runs on lnd1 and connects to external Nostr relays (default: `wss://nos.lol`, `wss://relay.mostro.network`).

## Building from source

Mostro is **built from source** (not pulled from Docker Hub). The setup script:

1. Clones the [Mostro repo](https://github.com/MostroP2P/mostro) into `mostro-src/` (or runs `git pull` if it already exists)
2. Builds the Docker image locally using `docker/Dockerfile` from the repo
3. Tags it as `mostro:local`

This ensures you always run the latest `main` branch. The first build takes a few minutes (Rust compilation). Subsequent runs of `setup.sh` will pull the latest changes and rebuild.

You can override the repo URL via `MOSTRO_REPO` in `.env`.

## Nostr key

Mostro needs a Nostr identity (nsec private key). The script handles this in three ways:

1. **From `.env`** — set `MOSTRO_NSEC_PRIVKEY=nsec1...` to skip prompts entirely
2. **Interactive prompt** — paste your existing nsec key when asked
3. **Auto-generate with rana** — press Enter at the prompt to build [rana](https://github.com/grunch/rana) and generate a new keypair (first build takes a few minutes)

The private key is saved to `mostro/nostr-private.txt` (chmod 600). The public key (npub) is displayed on screen at the end of setup.

## File locations

```
mostro/
├── settings.toml       # generated — Mostro configuration
├── nostr-private.txt   # nsec key (chmod 600)
└── lnd/
    ├── tls.cert        # copied from lnd1
    └── admin.macaroon  # copied from lnd1
```

All files under `mostro/` are generated by the script and git-ignored.

## MostriX (TUI client)

[MostriX](https://github.com/MostroP2P/mostrix) is a terminal user interface (TUI) client for interacting with Mostro. It replaces the old `mostro-cli` tool and provides a full-screen interactive experience for browsing orders, creating trades, and managing admin disputes.

The setup script automatically:

1. Clones the [MostriX repo](https://github.com/MostroP2P/mostrix) into `mostrix-src/`
2. Installs system dependencies (`cmake`, `build-essential`, `pkg-config`)
3. Builds with `cargo build --release` (requires Rust 1.90+)
4. Configures `~/.mostrix/settings.toml` with the local Mostro instance's pubkey, relays, and admin key

You can override the repo URL via `MOSTRIX_REPO` in `.env`.

### Using MostriX

```bash
mostrix     # launch the TUI (alias installed by setup.sh)
```

Key bindings:

| Key | Action |
|-----|--------|
| Left/Right | Switch tabs |
| Up/Down | Navigate lists |
| Enter | Select/confirm |
| Q | Quit |
| M | Toggle User/Admin mode |
| C | Copy invoice to clipboard |
| Esc | Cancel/close popup |

### MostriX file locations

```
~/.mostrix/
├── settings.toml    # configuration (mostro pubkey, relays, keys)
├── mostrix.db       # SQLite database (orders, users, disputes)
└── downloads/       # saved chat attachments
```
